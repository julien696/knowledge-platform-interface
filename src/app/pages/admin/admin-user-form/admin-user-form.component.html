<main>
    <div class="form-container">
        <div class="form-card">
            <h1>{{ isEditMode ? 'Modifier l\'utilisateur' : 'Créer un utilisateur' }}</h1>
            
            <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="admin-form">
                
                <div class="form-group">
                    <label for="name">Nom complet</label>
                    <input
                        type="text"
                        id="name"
                        formControlName="name"
                        class="form-control"
                        [class.error]="name?.invalid && name?.touched"
                        placeholder="Nom complet">
                    
                    <div *ngIf="name?.invalid && name?.touched" class="error-message">
                        <span *ngIf="name?.errors?.['required']">Le nom est requis</span>
                        <span *ngIf="name?.errors?.['minlength']">Minimum 2 caractères</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="email">Email</label>
                    <input
                        type="email"
                        id="email"
                        formControlName="email"
                        class="form-control"
                        [class.error]="email?.invalid && email?.touched"
                        placeholder="email@example.com">
                    
                    <div *ngIf="email?.invalid && email?.touched" class="error-message">
                        <span *ngIf="email?.errors?.['required']">L'email est requis</span>
                        <span *ngIf="email?.errors?.['email']">Format d'email invalide</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="role">Rôle</label>
                    <select
                        id="role"
                        formControlName="role"
                        class="form-control">
                        <option value="user">Utilisateur</option>
                        <option value="admin">Administrateur</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="plainPassword">
                        Mot de passe {{ isEditMode ? '(laisser vide pour ne pas changer)' : '' }}
                    </label>
                    <input
                        type="password"
                        id="plainPassword"
                        formControlName="plainPassword"
                        class="form-control"
                        [class.error]="plainPassword?.invalid && plainPassword?.touched"
                        [placeholder]="isEditMode ? 'Nouveau mot de passe (optionnel)' : 'Mot de passe'">
                    
                    <div *ngIf="plainPassword?.invalid && plainPassword?.touched" class="error-message">
                        <span *ngIf="plainPassword?.errors?.['minlength']">Minimum 6 caractères</span>
                    </div>
                </div>

                <div *ngIf="error" class="error-general">
                    {{ error }}
                </div>

                <div class="form-actions">
                    <button
                        type="submit"
                        class="btn-primary"
                        [disabled]="userForm.invalid">
                        <span *ngIf="isEditMode">{{ isEditMode ? 'Modification...' : 'Création...' }}</span>
                        <span *ngIf="!isEditMode">{{ isEditMode ? 'Modifier' : 'Créer' }}</span>
                    </button>
                    
                    <button
                        type="button"
                        class="btn-secondary"
                        (click)="router.navigate(['/admin'])">
                        Annuler
                    </button>
                </div>
            </form>
        </div>
    </div>
</main>